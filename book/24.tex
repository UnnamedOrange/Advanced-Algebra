% Licensed under the Creative Commons Attribution Share Alike 4.0 International.
% See the LICENCE file in the repository root for full licence text.

\section{矩阵的相似}

矩阵的相似是本笔记中最重要的内容之一，其研究动力如下。为了求 $n$ 级矩阵 $A$ 的方幂 $A^m$，如果能找到 $n$ 级可逆矩阵 $P$，使得 $P^{-1} AP = D$，其中 $D$ 是对角矩阵，那么 $A = PDP^{-1}$，从而 $A^m = PD^m P^{-1}$，而对角矩阵 $D$ 的方幂很容易计算，于是 $A^m$ 也就比较容易算出了。据此，我们定义相似的概念。

\subsection{相似的概念}

\begin{definition}{相似}
	设 $A$ 与 $B$ 都是数域 $K$ 上的 $n$ 级矩阵，如果存在数域 $\mathbb K$ 上一个 $n$ 级可逆矩阵 $P$，使得 $P^{-1} A P = B$，那么称 $A$ 与 $B$ 是\emph{相似}的，记作 $A \sim B$。
\end{definition}

\begin{theorem}
	相似是一个等价关系。
\end{theorem}

\begin{definition}{相似类}
	在相似关系下，$A$ 的等价类称为 $A$ 的\emph{相似类}。
\end{definition}

容易证明，矩阵的相似满足以下性质。

\begin{theorem}[相似的运算性质]
	如果 $B_1 = P^{-1} A_1 P$，$B_2 = P^{-1} A_2 P$，$m$ 是正整数，那么：
	\begin{enumerate}
		\item $B_1 + B_2 = P^{-1} (A_1 + A_2) P$。
		\item $B_1 B_2 = P^{-1} (A_1 A_2) P$。
		\item $B_1^m = P^{-1} A_1^m P$。
	\end{enumerate}
\end{theorem}

\begin{theorem}
	相似的矩阵的行列式是一个不变量，但不是完全不变量。
\end{theorem}

\begin{theorem}
	相似的矩阵或者都可逆，或者都不可逆；当它们可逆时，它们的逆矩阵也相似。
\end{theorem}

\begin{theorem}
	相似的矩阵的秩是一个不变量，但不是完全不变量。
\end{theorem}

下面我们提出矩阵的迹的概念，并证明相似的矩阵的迹也是一个不变量。

\begin{definition}{迹}
	$n$ 级矩阵 $A = (a_{ij})$ 的主对角线上的元素之和称为 $A$ 的\emph{迹}，记作 $\operatorname{tr}(A)$， 即 $\operatorname{tr}(A) = a_{11} + a_{22} + \cdots + a_{nn}$。
\end{definition}

\begin{theorem}[矩阵的迹的运算性质]
	\begin{enumerate}
		\item 对 $n$ 级矩阵，$\operatorname{tr}(A + B) = \operatorname{tr}(A) + \operatorname{tr}(B)$。
		\item 对 $n$ 级矩阵，$\operatorname{tr}(kA) = k \operatorname{tr}(A)$。
		\item 对 $n \times m$ 矩阵 $A$ 和 $m \times n$ 矩阵 $B$，$\operatorname{tr}(AB) = \operatorname{tr}(BA)$。
	\end{enumerate}
\end{theorem}

\begin{proof}[只证明 3.]
	$$
	\begin{aligned}
		\operatorname{tr}(AB) &= \sum_{i = 1}^n (AB)(i; i)
		\\&=
		\sum_{i = 1}^n \sum_{k = 1}^m a_{ik} b_{ki}
		\\&=
		\sum_{k = 1}^m \sum_{i = 1}^n b_{ki} a_{ik}
		\\&=
		\sum_{k = 1}^m (BA)(k;k) = \operatorname{tr}(BA)
	\end{aligned}
	$$
\end{proof}

可见，矩阵的迹是从矩阵乘法的非交换性中提取的可交换的量。

\begin{theorem}
	相似的矩阵有相等的迹。
\end{theorem}

\begin{proof}
	$$
	\operatorname{tr}(B) = \operatorname{tr}(P^{-1} A P) = \operatorname{tr}(APP^{-1}) = \operatorname{tr}(A)
	$$
\end{proof}

综合以上定理，我们总结出相似不变量的概念。

\begin{definition}{相似不变量}
	矩阵的行列式、秩、迹都是相似关系下的不变量，简称为\emph{相似不变量}。
\end{definition}

% TODO: 补充例题。

\subsection{矩阵可对角化的概念}

\begin{definition}{可对角化}
	如果 $n$ 级矩阵 $A$ 能够相似于一个对角矩阵，那么称 $A$ \emph{可对角化}。
\end{definition}

我们直接给出矩阵可对角化的充分必要条件。

\begin{theorem}[矩阵可对角化的充分必要条件]
	数域 $\mathbb K$ 上 $n$ 级矩阵 $A$ 可对角化的充分必要条件是，$\mathbb K^n$ 中有 $n$ 个线性无关的列向量 $\vec \alpha_1, \ldots, \vec \alpha_n$，以及 $\mathbb K$ 中有 $n$ 个数 $\lambda_1, \ldots, \lambda_n$（它们之中可能相等），使得 $A \vec \alpha_i = \lambda_i \vec \alpha_i \pod{i = 1, \ldots, n}$。这时，令 $P = \begin{bmatrix} \vec \alpha_1 & \cdots & \vec \alpha_n \end{bmatrix}$，则 $P^{-1} AP = \operatorname{diag} \{ \lambda_1, \ldots, \lambda_n \}$。
\end{theorem}

\begin{proof}
	设 $D = \operatorname{diag} \{ \lambda_1, \ldots, \lambda_n \}$，则以下命题互为充分必要条件：

	\begin{itemize}
		\item $A$ 相似于一个对角矩阵，即 $P^{-1} AP = D$。
		\item $AP = PD$，设 $P = \begin{bmatrix} \vec \alpha_1 & \cdots & \vec \alpha_n \end{bmatrix}$。
		\item $\begin{bmatrix} A \vec \alpha_1 & \cdots & A \vec \alpha_n \end{bmatrix} =  \begin{bmatrix} \lambda_1 \vec \alpha_1 & \cdots & \lambda_n \vec \alpha_n \end{bmatrix}$
		\item $A \vec \alpha_i = \lambda_i \vec \alpha_i \pod{i = 1, \ldots, n}$，其中 $\vec \alpha_1, \cdots, \vec \alpha_n$ 线性无关。
	\end{itemize}
\end{proof}

\subsection{特征多项式}

根据以上关于矩阵可对角化的分析，我们可以提出以下概念。

\begin{definition}{特征值,特征向量}
	设 $A$ 是数域 $\mathbb K$ 上的 $n$ 级矩阵，如果 $\mathbb K^n$ 中有非零列向量 $\vec \alpha$，使得 $A \vec \alpha = \lambda_0 \vec \alpha \pod{\lambda_0 \in \mathbb K}$，那么称 $\lambda_0$ 是 $A$ 的一个\emph{特征值}，称 $\vec \alpha$ 是 $A$ 的属于特征值 $\lambda_0$ 的一个\emph{特征向量}。
\end{definition}

注意，根据定义，零向量不是 $A$ 的特征向量。

关于特征值与特征向量，我们首先给出以下显然的结论。

\begin{theorem}
	如果 $\vec \alpha$ 是 $A$ 的属于 $\lambda_0$ 的一个特征向量，那么对于任意 $k \in \mathbb K \pod{k \ne 0}$，$k \vec \alpha$ 也是 $A$ 的属于 $\lambda_0$ 的特征向量。
\end{theorem}

\begin{proof}
	$$
	A(k \vec \alpha) = k(A \vec \alpha) = k(\lambda_0 \vec \alpha) = \lambda_0 (k \vec \alpha)
	$$
\end{proof}

根据以上定义，又受可对角化的充分必要条件的推导过程启发，我们可知以下命题互为充分必要条件：

\begin{itemize}
	\item $\lambda_0$ 是 $A$ 的一个特征值，$\vec \alpha$ 是 $A$ 的属于 $\lambda_0$ 的一个特征向量。
	\item $A \vec \alpha = \lambda_0 \vec \alpha \pod{\vec \alpha \ne \vec 0, \lambda_0 \in \mathbb K}$
	\item $(\lambda_0 I - A) \vec \alpha = \vec 0 \pod{\vec \alpha \ne \vec 0, \lambda_0 \in \mathbb K}$
	\item $\vec \alpha$ 是齐次线性方程组 $(\lambda_0 I - A) \vec x = \vec 0$ 的一个非零解（$\lambda_0 \in \mathbb K$）。
	\item $|\lambda_0 I - A| = 0$，$\vec \alpha$ 是 $(\lambda_0 I - A) \vec x = \vec 0$ 的一个非零解（$\lambda_0 \in \mathbb K$）。
	\item $\lambda_0$ 是\textbf{多项式} $|\lambda I - A|$ 在 $\mathbb K$ 中的一个根，$\vec \alpha$ 是 $(\lambda_0 I - A) \vec x = \vec 0$ 的一个非零解。
\end{itemize}

将行列式 $|\lambda I - A|$ 的完全展开式看作一个关于 $\lambda$ 的多项式，即得到了上文中的多项式 $|\lambda I - A|$。
$$
|\lambda I - A| =
\begin{vmatrix}
\lambda - a_{11} & -a_{12} & \cdots & -a_{1n}
\\
-a_{21} & \lambda - a_{22} & \cdots & -a_{2n}
\\
\vdots & \vdots & & \vdots
\\
-a_{n1} & -a_{n2} & \cdots & \lambda - a_{nn}
\end{vmatrix}
$$

\begin{definition}{特征多项式}
	把 $|\lambda I - A|$ 称为 $A$ 的\emph{特征多项式}。
\end{definition}

以下定理描述了多项式 $|\lambda I - A|$ 的结构。

\begin{theorem}
	设 $A$ 是数域 $\mathbb K$ 上的 $n$ 级矩阵，则 $A$ 的特征多项式 $|\lambda I - A|$ 是一个 $n$ 次多项式，$\lambda^n$ 的系数是 $1$，$\lambda^{n - 1}$ 的系数等于 $-\operatorname{tr}(A)$，常数项为 $(-1)^n |A|$，$\lambda^{n - k}$ 的系数为 $A$ 的所有 $k$ 阶主子式的和乘以 $(-1)^k \pod{1 \le k < n}$。
\end{theorem}

\begin{proof}
	设 $A = (a_{ij})$ 的列向量组是 $\vec \alpha_1, \ldots, \vec \alpha_n$，写出 $|\lambda I - A|$：
	$$
	|\lambda I - A| =
	\begin{vmatrix} \lambda \vec e_1 - \vec \alpha_1 & \lambda \vec e_2 - \vec \alpha_2 & \cdots & \lambda \vec e_n - \vec \alpha_n \end{vmatrix}
	$$
	利用行列式的多线性，$|\lambda I - A|$ 可以拆成 $2^n$ 个行列式的和，我们把它按全是 $\vec e$，全是 $\vec \alpha$，既有 $\vec e$ 又有 $\vec \alpha$ 分成三类。

	第一类，显然这个行列式等于 $\lambda^n$。第二类，显然这个行列式等于 $(-1)^n |A|$。对于第三类行列式，设第 $j_1, j_2, \ldots, j_{n - k}$ 列是 $\vec e$，于是可以将这个行列式按第 $j_1, j_2, \ldots, j_{n - k}$ 列展开。这 $n - k$ 列元素组成的 $n - k$ 阶子式只有一个不为 $0$，即选出第 $j_1, \ldots, j_{n - k}$ 行的那一个不为 $0$，还可知这个 $n - k$ 阶子式就是 $|\lambda I_{n - k}| = \lambda^{n - k}$。而剩下的 $k$ 阶子式对应的代数余子式为：
	$$
	(-1)^{(j_1 + \cdots + j_k) + (j_1 + \cdots + j_k)} (-A) \begin{pmatrix} j'_1, \ldots, j'_k \\ j'_1, \ldots, j'_k \end{pmatrix} = (-1)^k A \begin{pmatrix} j'_1, \ldots, j'_k \\ j'_1, \ldots, j'_k \end{pmatrix}
	$$

	于是第三类行列式的值为：$(-1)^k A \begin{pmatrix} j'_1, \ldots, j'_k \\ j'_1, \ldots, j'_k \end{pmatrix} \lambda^{n - k}$。特别地，当 $k = 1$ 时，得 $\lambda^{n - 1}$ 的系数为 $-\operatorname{tr}(A)$。综上，可以写出 $\lambda^{n - k}$ 的系数，即可得到 $A$ 的特征多项式的系数表示形式。
	$$
	\lambda^n - \operatorname{tr}(A) + \cdots + (-1)^k \sum_{1 \le j'_1 < \cdots < j'_k \le n} A \begin{pmatrix} j'_1, \ldots, j'_k \\ j'_1, \ldots, j'_k \end{pmatrix} \lambda^{n - k} + \cdots + (-1)^n |A|
	$$
\end{proof}

由代数学基本定理，复数域上的特征多项式亦可用以下定理所示的形式表示。

\begin{theorem}
	设 $A \in M_n (\C)$，则 $A$ 的特征多项式为：
	$$
	|\lambda I - A| = (\lambda - \lambda_1) (\lambda - \lambda_2) \cdots (\lambda - \lambda_n)
	$$
	其中 $\lambda_1, \ldots, \lambda_n$ 是 $A$ 的特征值（可重）。

	$A$ 的特征多项式亦可记作：
	$$
	|\lambda I - A| = (\lambda - \lambda_1)^{l_1} (\lambda - \lambda_2)^{l_2} \cdots (\lambda - \lambda_m)^{l_m}
	$$
	其中 $\lambda_1, \ldots, \lambda_m$ 是 $A$ 的特征值（互不相同）。
\end{theorem}

综合以上两个定理，可知复数域上的矩阵的所有 $k$ 阶主子式之和满足以下性质。

\begin{theorem}
	设 $A \in M_n(\C)$，设 $A$ 的特征值为 $\lambda_1, \lambda_2, \ldots, \lambda_n$（可重），则 $A$ 的所有 $k$ 阶主子式之和为 $\sum\limits_{1 \le j_1 < \cdots < j_{n - k} \le n} \lambda_{j_1} \cdots \lambda_{j_{n - k}}$。
\end{theorem}

\begin{proof}
	设 $A$ 的所有 $k$ 阶主子式之和为 $A_k$。由于 $\lambda^{n - k}$ 的系数为 $(-1)^k A_k$，又等于 $(-1)^k \sum\limits_{1 \le j_1 < \cdots < j_{n - k} \le n} \lambda_{j_1} \cdots \lambda_{j_{n - k}}$。即可知 $A_k = \sum\limits_{1 \le j_1 < \cdots < j_{n - k} \le n} \lambda_{j_1} \cdots \lambda_{j_{n - k}}$。
\end{proof}

之所以特征多项式可以作为矩阵的一个特征，是因为相似的矩阵有相等的特征多项式。

\begin{theorem}
	相似的矩阵有相等的特征多项式。
\end{theorem}

\begin{proof}
	设 $A \sim B$，则有可逆矩阵 $P$，使得 $B = P^{-1} A P$，于是：
	$$
	|\lambda I - B| = |\lambda I - P^{-1} A P| = |P^{-1} (\lambda I - A) P| = |P^{-1}| |\lambda I - A||P| = |\lambda I - A|
	$$
\end{proof}

\subsection{特征值的性质}

在研究了特征多项式的结构后，本节中将提出几个有关特征值的定理。

\begin{theorem}
	相似的矩阵有完全相同的特征值。
\end{theorem}

\begin{theorem}
	若 $A$ 可逆，则零不可能是 $A$ 的一个特征值。
\end{theorem}

\begin{proof}
	假设零是 $A$ 的一个特征值，则 $A$ 的行列式为 $0$，与 $A$ 可逆矛盾。
\end{proof}

\begin{theorem}
	$\lambda_0$ 为可逆矩阵 $A \in M_n(\C)$ 的特征值的充分必要条件是 $\dfrac{1}{\lambda_0}$ 为 $A^{-1}$ 的特征值。
\end{theorem}

\begin{proof}
	设 $|\lambda I - A| = (\lambda - \lambda_0)^{l_0} (\lambda - \lambda_1)^{l_1} \cdots (\lambda - \lambda_m)^{l_m}$，由代数学基本定理，$l_0 + \cdots + l_m = n$。

	考虑计算 $A^{-1}$ 的特征多项式，尝试从 $|\lambda I - A^{-1}|$ 化出 $|\lambda I - A|$ 的形式以展开成多项式。
	$$
	\begin{aligned}
		|\lambda I - A^{-1}| &= |\lambda A A^{-1} - A^{-1}| = |A^{-1}| |\lambda A - I| = (-\lambda)^n |A^{-1}| \biggl| \dfrac{1}{\lambda} I - A \biggr|
		\\&=
		(-\lambda)^n |A^{-1}| \biggl( \dfrac{1}{\lambda} - \lambda_0 \biggr)^{l_0} \cdots \biggl( \dfrac{1}{\lambda} - \lambda_m \biggr)^{l_m}
		\\&=
		|A^{-1}||A| \biggl( \lambda - \dfrac{1}{\lambda_0} \biggr)^{l_0} \cdots \biggl( \lambda - \dfrac{1}{\lambda_m} \biggr)^{l_m}
		\\&=
		\biggl( \lambda - \dfrac{1}{\lambda_0} \biggr)^{l_0} \cdots \biggl( \lambda - \dfrac{1}{\lambda_m} \biggr)^{l_m}
	\end{aligned}
	$$
\end{proof}

\begin{theorem}
	设 $A \in M_n(\C)$，$f(x) = \sum\limits_{i = 0}^s a_i x^i$。若 $A$ 的特征值为 $\lambda_1, \ldots, \lambda_n$（可重），则 $f(A)$ 的特征值为 $f(\lambda_1), \ldots, f(\lambda_n)$。同时，若 $f(A)$ 的特征值为 $\lambda_1, \ldots, \lambda_n$，则对每个 $\lambda_i$，都存在一个 $q$，使得 $f(q) = \lambda_i$，并且 $q$ 是 $A$ 的特征值。
\end{theorem}

\begin{proof}
	由于 $\lambda_1, \ldots, \lambda_n$ 为 $A$ 的特征值，故设 $\vec \alpha_i \in \C^n$ 为 $\lambda_i$ 对应的特征向量，即有 $A \vec \alpha_i = \lambda_i \vec \alpha_i$。

	考虑左乘一个 $A$，得 $A^2 \vec \alpha_i = A \cdot A \vec \alpha_i = A (\lambda_i \vec \alpha_i) = \lambda_i (A \vec \alpha_i) = \lambda_i^2 \vec \alpha_i$。同理归纳知，$A^m \vec \alpha_i = \lambda_i^m \vec \alpha_i$，从而有 $(a_m A^m) \vec \alpha_i = (a_m \lambda_i^m) \vec \alpha_i$。于是可以通过相加得 $f(A) \vec \alpha_i = f(\lambda_i) \vec \alpha_i$。即证得：若 $A$ 的特征值为 $\lambda_1, \cdots, \lambda_n$，则 $f(A)$ 的特征值为 $f(\lambda_1), \cdots, f(\lambda_n)$，并且 $A$ 的特征值 $\lambda_i$ 对应的特征子空间与 $f(A)$ 的特征值 $f(\lambda_i)$ 对应的特征子空间相等。

	\bigskip

	由于 $\lambda_1, \ldots, \lambda_n$ 为 $f(A)$ 的特征值，故设 $\vec v_i \in \C^n$ 为 $\lambda_i$ 对应的特征向量，即有 $f(A) \vec v_i = \lambda_i \vec v_i$。

	设 $f(x) - \lambda_i = C(x - q_1) \cdots (x - q_s)$（注意，这是一个 $s$ 次多项式，在 $\C$ 上一定有 $s$ 个解），则 $\lambda_i = f(q_j) \pod{1 \le j \le s}$。要证明原命题，只需证明：$\exists j \in \{1, 2, \cdots, s\}$，使得 $q_j$ 是 $A$ 的特征值。

	同时，由 $f(x) - \lambda_i$ 的分解，可知 $(A - q_1 I) \cdots (A - q_s I) \vec v_i = \vec 0$。注意到，若 $(A - q_2 I) \cdots (A - q_s I) \vec v_i \ne \vec 0$，则 $(A - q_2 I) \cdots (A - q_s I) \vec v_i$ 是 $A$ 的一个特征向量，对应特征值为 $q_1$，此时结论成立。

	否则，若 $(A - q_3 I) \cdots (A - q_s I) \vec v_i \ne \vec 0$，则 $(A - q_3 I) \cdots (A - q_s I) \vec v_i$ 是 $A$ 的一个特征向量，对应特征值为 $q_2$，此时结论成立。

	否则，继续照此进行检查，直到结论成立。最后一个式子可能是 $(A - q_s I) \vec v_i = \vec 0$，由于 $\vec v_i \ne \vec 0$，故在该情况下一定可以得出结论：$\vec v_i$ 是 $A$ 的一个特征向量，$q_s$ 是对应的特征值。
\end{proof}

\subsection{利用特征多项式进行矩阵对角化}

要得到与矩阵 $A$ 相似的对角矩阵，我们需要找出 $A$ 的特征值 $\lambda_i$ 和特征向量 $\vec \alpha_i$。有了特征多项式，我们只需要找出 $A$ 的特征值 $\lambda_i$，并利用 $\vec \alpha_i$ 是齐次线性方程组 $(\lambda_i I - A) \vec x = \vec 0$ 的解求出 $\vec \alpha_i$（并验证 $\vec \alpha_i$ 是否线性无关）。于是可以将过程分成三步：
\begin{enumerate}
	\item 解多项式的零点 $|\lambda I_n - A| = 0$，得到 $n$ 个解 $\lambda_1, \ldots, \lambda_n$（包括重解）。
	\item 对于每个 $\lambda_i$，解齐次线性方程组 $(\lambda_i I - A) \vec x = \vec 0$。对于每个方程组，将任一基础解系作为它的解。将所有方程组的非零解合在一起构成包含 $n$ 个向量的列向量组。
	\item 检查列向量组 $\vec \alpha_1, \ldots, \vec \alpha_n$ 是否线性无关。
\end{enumerate}

如果以上步骤能顺利进行，那么 $\lambda_i$ 即为 $A$ 的一个特征值，$\vec \alpha_j$ 为 $A$ 属于 $\lambda_i$ 的一个特征向量。

\bigskip

下面以斐波那契数列 $a_n = a_{n - 1} + a_{n - 2}$ 为例，展示矩阵对角化的分析方法。

\begin{solve}
	用矩阵表示斐波那契数列的递推公式为：
	$$
	\begin{bmatrix} a_n \\ a_{n - 1}\end{bmatrix}
	=
	\begin{bmatrix} 1 & 1 \\ 1 & 0 \end{bmatrix}
	\begin{bmatrix} a_{n - 1} \\ a_{n - 2} \end{bmatrix}
	$$

	设 $A = \begin{bmatrix} 1 & 1 \\ 1 & 0 \end{bmatrix}$，下面对 $A$ 进行对角化。

	\begin{enumerate}
		\item 解方程 $|\lambda I - A| = 0$。
		$$
		\begin{vmatrix}\lambda I - A\end{vmatrix} =
		\begin{vmatrix} \lambda - 1 & -1 \\ -1 & \lambda \end{vmatrix} =
		\lambda^2 - \lambda - 1 = 0
		$$

		解得 $\lambda_1 = \dfrac{1 - \sqrt 5}{2}, \lambda_2 = \dfrac{1 + \sqrt 5}{2}$。

		\item 分别解关于 $\vec X$ 的方程组 $A \vec X = \lambda_1 \vec X$，$A \vec X = \lambda_2 \vec X$。

		分别移项，得 $(\lambda_1 I - A) \vec X = \vec 0$，$(\lambda_2 I - A) \vec X = \vec 0$。注意到，$\lambda_1 I - A = \begin{bmatrix} \lambda_1 - 1 & -1 \\ -1 & \lambda_1 \end{bmatrix}$，$\lambda_2 I - A = \begin{bmatrix} \lambda_2 - 1 & -1 \\ -1 & \lambda_2 \end{bmatrix}$，它们的行列式都为 $0$，而它们都不是零矩阵，故它们的解空间的维数为 $2 - 1 = 1$。于是，设 $\vec X_1$ 为 $(\lambda_1 I - A) \vec X = \vec 0$ 的基础解系，$\vec X_2$ 为 $(\lambda_2 I - A) \vec X = \vec 0$ 的基础解系。此处省略计算结果。

		\item 验证 $\vec X_1$ 和 $\vec X_2$ 线性无关。此处省略计算过程。
	\end{enumerate}

	最终可知，$A$ 可对角化，且满足：
	$$
	A \begin{bmatrix} \vec X_1 & \vec X_2 \end{bmatrix} = \begin{bmatrix} \vec X_1 & \vec X_2 \end{bmatrix} \begin{bmatrix} \dfrac{1 + \sqrt 5}{2} & 0 \\ 0 & \dfrac{1 - \sqrt 5}{2} \end{bmatrix}
	$$

	注意其中的 $\vec X_1, \vec X_2$ 是求解出的两个常向量。
\end{solve}

\subsection{特征子空间}

求解对角矩阵的三个步骤中，我们已经研究了第一步涉及的特征多项式。下面我们研究第二步中涉及到的齐次线性方程组的解空间，我们称其为特征子空间。

\begin{definition}{特征子空间}
	设 $\lambda_j$ 是 $A$ 的一个特征值，把齐次线性方程组 $(\lambda_j I - A) \vec x = \vec 0$ 的解空间称为 $A$ 的属于 $\lambda_j$ 的\emph{特征子空间}，其中的全部非零向量就是 $A$ 的属于 $\lambda_j$ 的全部特征向量。
\end{definition}

根据特征子空间的定义可知，对于 $A$ 的每一个特征值 $\lambda_j$，设齐次线性方程组 $(\lambda_j I - A) \vec x = \vec 0$ 的一个基础解系为 $\vec \eta_1, \ldots, \vec \eta_t$，则 $A$ 属于 $\lambda_j$ 的全部特征向量组成的集合是：
$$
\{ k_1 \vec \eta_1 + \cdots + k_t \vec \eta_t \colon k_1, \cdots, k_t \in \mathbb K, \text{不全为 $0$} \}
$$

\subsection{重数}

不难注意到，$|\lambda I - A| = 0$ 可能会有重根，我们自然会问属于某个重根的特征子空间满足什么性质。为此我们提出重数的概念。

\begin{definition}{代数重数,重数}
	设 $A$ 是数域 $\mathbb K$ 上的 $n$ 级矩阵，$\lambda_1$ 是 $A$ 的一个特征值。把 $\lambda_i$ 作为 $A$ 的特征多项式的根的重数 $l_i$ 叫做 $\lambda_i$ 的\emph{代数重数}，简称为\emph{重数}。
\end{definition}

\begin{definition}{几何重数}
	设 $A$ 是数域 $\mathbb K$ 上的 $n$ 级矩阵，$\lambda_1$ 是 $A$ 的一个特征值。把 $A$ 的属于 $\lambda_1$ 的特征子空间的维数叫做特征值 $\lambda_1$ 的\emph{几何重数}。
\end{definition}

设 $A$ 的一个特征值为 $\lambda_i$，其对应的特征子空间为：
$$
V_{\lambda_i} = \{\vec X \in \mathbb K^n \colon (\lambda_i I - A) \vec X = \vec 0\}
$$

则特征值 $\lambda_i$ 的几何重数为 $\dim V_{\lambda_i} = n - \mathrm{rank}(\lambda_i I -A)$\footnote{$\dim \operatorname{Ker} \phi = n - \operatorname{rank}(A)$}。

事实上，代数重数和几何重数具有如下关系。

\begin{theorem}
	设 $\lambda_1$ 是数域 $\mathbb K$ 上 $n$ 级矩阵 $A$ 的一个特征值，则 $\lambda_1$ 的几何重数不超过它的代数重数。
\end{theorem}

\begin{proof}[构造可逆矩阵 $P$]
	设 $A$ 的属于特征值 $\lambda_1$ 的特征子空间 $W_1$ 的维数为 $r$。在 $W_1$ 中取一个基 $\vec \alpha_1, \vec \alpha_2, \ldots, \vec \alpha_r$，把它扩充为 $\mathbb K^n$ 的一个基 $\vec \alpha_1, \vec \alpha_2, \ldots, \vec \alpha_r, \vec \beta_1, \ldots, \vec \beta_{n - r}$。把这 $n$ 个向量放进矩阵 $P$ 中，即：
	$$
	P = \begin{bmatrix} \vec \alpha_1 & \vec \alpha_2 & \cdots & \vec \alpha_r & \vec \beta_1 & \cdots & \vec \beta_{n - r} \end{bmatrix}
	$$

	这 $n$ 个向量线性无关，所以 $P$ 可逆。

	计算 $AP = \begin{bmatrix} A \vec \alpha_1 & \cdots & A \vec \alpha_r & A \vec \beta_1 & \cdots & A \vec \beta_{n - r} \end{bmatrix}$。其中，$A \vec \alpha_i = \lambda_1 \vec \alpha_i$，而 $A \vec \beta_i$ 是 $\vec \alpha_1, \ldots, \vec \alpha_r, \vec \beta_1, \ldots, \vec \beta_{n - r}$ 的线性组合，于是可以把 $AP$ 写成两个矩阵相乘的形式：
	$$
	\begin{aligned}
		AP =&
		\begin{bmatrix} \vec \alpha_1 & \vec \alpha_2 & \cdots & \vec \alpha_r & \vec \beta_1 & \cdots & \vec \beta_{n - r} \end{bmatrix} \cdot
		\\&
		\begin{bmatrix}
			\lambda_1 & 0 & \cdots & 0 & p_{11} & \cdots & p_{1, n - r}
			\\
			0 & \lambda_1 & \cdots & 0 & p_{21} & \cdots & p_{r, n - r}
			\\
			\vdots & \vdots & & \vdots & \vdots & & \vdots
			\\
			0 & 0 & \cdots & \lambda_1 & p_{r1} & \cdots & p_{r, n - r}
			\\
			0 & 0 & \cdots & 0 & q_{11} & \cdots & q_{1, n - r}
			\\
			0 & 0 & \cdots & 0 & q_{21} & \cdots & q_{2, n - r}
			\\
			\vdots & \vdots & & \vdots & \vdots & & \vdots
			\\
			0 & 0 & \cdots & 0 & q_{n - r, 1} & \cdots & q_{n - r, n - r}
		\end{bmatrix}
	\end{aligned}
	$$

	右侧矩阵写成分块矩阵为 $\begin{bmatrix} \lambda_1 I & \tilde P \\ 0 & \tilde Q \end{bmatrix}$。于是，$AP = P \begin{bmatrix} \lambda_1 I & \tilde P \\ 0 & \tilde Q \end{bmatrix}$。由于 $P$ 是可逆矩阵，所以 $A \sim \begin{bmatrix} \lambda_1 I & \tilde P \\ 0 & \tilde Q \end{bmatrix}$。由此可知 $A$ 的特征多项式与 $\begin{bmatrix} \lambda_1 I & \tilde P \\ 0 & \tilde Q \end{bmatrix}$ 的特征多项式相等。计算：
	$$
	|\lambda I - A| =
	\begin{vmatrix}
	(\lambda - \lambda_1) I_{r} & - \tilde P
	\\
	0 & \lambda I_{n - r} - \tilde Q
	\end{vmatrix}
	=
	(\lambda - \lambda_1)^{r} |\lambda I_{n - r} - \tilde Q|
	$$

	$|\lambda I_{n - r} - \tilde Q|$ 即 $Q$ 的特征多项式。其中可能有 $(\lambda - \lambda_1)$ 这个因数，也可能没有。设 $(\lambda - \lambda_1)$ 这个因数在特征多项式的幂次为 $l$，故 $r \le l$。
\end{proof}

\subsection{矩阵可对角化的条件}

通过尝试对角化以下矩阵，我们将总结出一系列判断矩阵是否可对角化的依据和相关定理。
$$
A = \begin{bmatrix} 0 & 1 & 2 \\ 0 & 0 & 1 \\ 0 & 0 & 1 \end{bmatrix}
$$

\begin{solve}
	\begin{enumerate}
		\item 求特征多项式的零点。

		$$
		|\lambda I - A| = \begin{vmatrix} \lambda & -1 & -2 \\ 0 & \lambda & -1 \\ 0 & 0 & \lambda - 1 \end{vmatrix} = \lambda^2(\lambda - 1)
		$$

		可知 $A$ 的特征值为 $0$ 和 $1$，对应代数重数为 $2$ 和 $1$。

		\item 求特征向量。

		注意到，\textbf{代数重数为 $1$ 的特征值的几何重数一定为 $1$。因为 $\operatorname{rank} (\lambda_1 I - A) < n$，所以一定能找到属于它的特征向量，其几何重数不可能为 $0$}。而对于特征值 $0$，计算 $\operatorname{rank}(0 - A) = 2$，则 $\dim V_0 = 3 - 2 = 1$，即特征值 $0$ 对应的几何重数为 $1$。

		具体求解过程略。但可以知道，由于特征值 $0$ 的几何重数为 $1$，因而找不到两个线性无关的属于它的特征向量。因为无法找到三个线性无关的特征向量，所以 $A$ 不可对角化。

		\item 验证基础解系的并线性无关。

		由于第 2 步就已经失败，所以无法进行第 3 步。
	\end{enumerate}
\end{solve}

仍以尝试对角化三阶矩阵的过程为例，现在假设特征值 $1$ 的几何重数是 $1$，但特征值 $0$ 的几何重数为 $2$，我们能否因为两者之和等于 $3$ 而断言存在三个线性无关的特征向量？下述定理说明了这样断言的正确性。

