% Licensed under the Creative Commons Attribution Share Alike 4.0 International.
% See the LICENSE file in the repository root for full license text.

\section{齐次线性方程组的解集的结构}

\begin{definition}{解向量}
	数域 $\mathbb K$ 上的 $n$ 元齐次线性方程组 $x_1 \vec \alpha_1 + x_2 \vec \alpha_2 + \cdots + x_n \vec \alpha_n = \vec 0$ 的一个解是 $\mathbb K^n$ 中的一个向量，称它为齐次线性方程组的一个\emph{解向量}。
\end{definition}

用解向量的观点来考察方程组的解集，可知 $n$ 元齐次线性方程组的解集 $W$ 是 $\mathbb K^n$ 的一个非空子集。本节的目的便是研究 $W$ 的结构。

注意到有：
\begin{enumerate}
	\item 若 $\vec \gamma, \vec \delta \in W$，则 $\vec \gamma + \vec \delta \in W$。
	\item 若 $\vec \gamma \in W, k \in \mathbb K$，则 $k \vec \gamma \in W$。
\end{enumerate}

所以 $W$ 是 $\mathbb K^n$ 的一个子空间，我们将其称为解空间。

\begin{definition}{解空间}
	齐次线性方程组的解集 $W$ 是 $\mathbb K^n$ 的一个子空间，称它为方程组的\emph{解空间}。
\end{definition}

要进一步研究解空间的结构，自然想到要研究解空间的基。为此，我们给出以下概念。

\begin{definition}{基础解系}
	齐次线性方程组有非零解时，如果它的有限多个解 $\vec \eta_1, \vec \eta_2, \ldots, \vec \eta_t$ 满足：
	\begin{enumerate}
		\item $\vec \eta_1, \vec \eta_2, \ldots, \vec \eta_t$ 线性无关。
		\item 齐次线性方程组的每一个解都可以由 $\vec \eta_1, \vec \eta_2, \ldots, \vec \eta_t$ 线性表出。
	\end{enumerate}
	则称 $\vec \eta_1, \vec \eta_2, \ldots, \vec \eta_t$ 是齐次线性方程组的一个\emph{基础解系}。
\end{definition}

基础解系的定义与基的定义相同，只是把研究对象限定为解空间了。

如果已知齐次线性方程组的一个基础解系 $\vec \eta_1, \vec \eta_2, \ldots, \vec \eta_t$，那么我们其实已经知道齐次线性方程组的解集 $W$。
$$
W = \langle \vec \eta_1, \vec \eta_2, \ldots, \vec \eta_t \rangle
$$

所以我们研究如何得到基础解系即可。利用构造法，我们可以得出以下定理。

\begin{theorem}
	数域 $\mathbb K$ 上的 $n$ 元齐次线性方程组的解空间 $W$ 的维数为 $\dim W = n - \operatorname{rank}(A)$，其中 $A$ 是方程组的系数矩阵。从而当齐次线性方程组有非零解时，它的每个基础解系所含解向量的个数都为 $n - \operatorname{rank}(A)$。
\end{theorem}

\begin{proof}[构造法]
	若 $\operatorname{rank}(A) = n$，则 $W = \{\vec 0\}$，显然成立。下面设 $\operatorname{rank}(A) = r < n$。

	对 $A$ 进行初等行变换，化成简化行阶梯形矩阵 $J$。可知 $J$ 有 $r$ 个主元，不妨设它们分别在第 $1, 2, \ldots, r$ 列，于是齐次线性方程组的一般解为：
	$$
	\begin{cases}
		x_1 = -b_{1, r + 1} x_{r + 1} - \cdots - b_{1n} x_n
		\\
		x_2 = -b_{2, r + 1} x_{r + 1} - \cdots - b_{2n} x_n
		\\
		\vdots
		\\
		x_r = -b_{r, r + 1} x_{r + 1} - \cdots - b_{rn} x_n
	\end{cases}
	$$

	让自由未知量 $x_{r + 1}, \ldots, x_n$ 分别取下述 $n - r$ 组数：
	$$
	\begin{pmatrix}
		1 \\ 0 \\ \vdots \\ 0
	\end{pmatrix},
	\begin{pmatrix}
		0 \\ 1 \\ \vdots \\ 0
	\end{pmatrix},
	\ldots,
	\begin{pmatrix}
		0 \\ 0 \\ \vdots \\ 1
	\end{pmatrix}
	$$

	则由一般解的公式可得方程组的 $n - r$ 个解：
	$$
	\vec \eta_1 =
	\begin{pmatrix}
		-b_{1, r + 1} \\ -b_{2, r + 1} \\ \vdots \\ -b_{r, r + 1} \\ 1 \\ 0 \\ \vdots \\ 0
	\end{pmatrix},
	\ldots,
	\vec \eta_{n - r} =
	\begin{pmatrix}
		-b_{1n} \\ -b_{2n} \\ \vdots \\ -b_{rn} \\ 0 \\ 0 \\ \vdots \\ 1
	\end{pmatrix}
	$$

	显然 $\vec \eta_1, \vec \eta_2, \ldots, \vec \eta_{n - r}$ 线性无关。而对于齐次线性方程组的任意一组解，都显然可以由 $\vec \eta_1, \vec \eta_2, \ldots, \vec \eta_{n - r}$ 线性表出，从而 $\vec \eta_1, \vec \eta_2, \ldots, \vec \eta_{n - r}$ 是方程组的一个基础解系，它包含的解向量的个数为 $n - \operatorname{rank}(A)$，于是 $\dim W = n - \operatorname{rank}(A)$。证毕。
\end{proof}

非齐次线性方程组的解集的结构又如何？设其对应的齐次线性方程组（常数项从 $\vec \beta$ 改为 $\vec 0$，称这个齐次线性方程组为原方程组的\emph{导出组}\index{导出组}）的解空间为 $W$，事实上，非齐次线性方程组的解集是一个 $W$ 型的\emph{线性流形}\index{线性流形}。相关的内容请自行查阅，本笔记不予讨论。

\subsection{子空间的交的基}

我们尝试用以上知识来解决下面这个问题。设 $V_1, V_2$ 是 $\mathbb K^n$ 的向量子空间。设 $V_1$ 的一组基是 $\vec \alpha_1, \ldots, \vec \alpha_s$，$V_2$ 的一组基是 $\vec \beta_1, \ldots, \vec \beta_t$，求 $V_1 \cap V_2$ 的一组基。

\begin{solve}
	可以知道，$\forall \vec \alpha \in V_1 \cap V_2$，可以表示为：
	$$
	\vec \alpha = k_1 \vec \alpha_1 + \cdots + k_s \vec \alpha_s = l_1 \vec \beta_1 + \cdots + l_t \vec \beta_t
	$$

	移项得：
	$$
	k_1 \vec \alpha_1 + \cdots + k_s \vec \alpha_s - l_1 \vec \beta_1 - \cdots - l_t \vec \beta_t = \vec 0
	$$

	注意，上面是一个有 $s + t$ 个未知量、$n$ 个方程的齐次线性方程组，设其基础解系为 $\vec \delta_1, \ldots, \vec \delta_q$。具体地，设：
	$$
	\vec \delta_i = (a_{i1}, \ldots, a_{is}, a_{i, s + 1}, \ldots, a_{i, s + t})' \pod{i = 1, \ldots, q}
	$$

	则可以得到一组“基” $a_{i1} \vec \alpha_1 + \cdots + a_{is} \vec \alpha_s \pod{i = 1, \ldots, q}$。下面证明，它们确实是一组基，即它们满足：
	\begin{enumerate}
		\item 这 $q$ 个向量线性无关。
		\item $V_1 \cap V_2$ 中的每一个向量都可以由这 $q$ 个向量线性表出。
	\end{enumerate}

	证明：
	\begin{enumerate}
		\item 写出向量组线性无关的等式：
		$$
		a_1 (a_{11} \vec \alpha_1 + \cdots + a_{1s} \vec \alpha_s) + \cdots + a_q(a_{q1} \vec \alpha_1 + \cdots + a_{qs} \vec \alpha_s) = \vec 0
		$$

		即要证明 $a_i = 0 \pod{i = 1, 2, \ldots, q}$。可得其中 $\vec \alpha_i$ 的系数为：
		$$
		a_1 a_{1i} + \cdots + a_q a_{qi} \pod{i = 1, \ldots, s}
		$$

		由于 $\vec \alpha_i \pod{i = 1, \ldots, s}$ 线性无关，所以上式都等于 $0$。于是再列出关于 $a_i$ 的方程组：
		$$
		a_1 a_{1i} + \cdots + a_q a_{qi} = 0 \pod{i = 1, \ldots, s}
		$$

		另一方面，将 $\vec \alpha$ 关于 $\vec \beta_i$ 的等式代入，得：
		$$
		a_1(a_{1, s + 1} \vec \beta_1 + \cdots + a_{1, s + t} \vec \beta_t) + \cdots + a_q(a_{q, s + 1} \vec \beta_1 + \cdots + a_{q, s + t} \vec \beta_t) = \vec 0
		$$

		于是得 $\vec \beta_i$ 的系数为 $a_1 a_{s + 1, i} + \cdots + a_q a_{s + t, i}$，由于 $\vec \beta_i \pod{i = 1, \ldots, t}$ 线性无关，因此这些系数也都是 $0$。综合以上内容，我们得到了 $s + t$ 个方程：
		$$
		a_1 a_{1i} + \cdots + a_q a_{qi} = 0 \pod{i = 1, \ldots, s}
		$$$$
		a_1 a_{1, s + j} + \cdots + a_q a_{q, s + j} = 0 \pod{j = 1, \ldots, t}
		$$

		由基础解系线性无关，得 $a_1, \ldots, a_q$ 均为 $0$。即得 $a_{i1} \vec \alpha_1 + \cdots + a_{is} \vec \alpha_s \pod{i = 1, \ldots, q}$ 线性无关。

		\item 由 $\vec \delta_i \pod{i = 1, \ldots, q}$ 是 $k_1 \vec \alpha_1 + \cdots + k_s \vec \alpha_s - l_1 \vec \beta_1 - \cdots - l_t \vec \beta_t = \vec 0$ 的基础解系，可知 $\vec \delta_i \pod{i = 1, \ldots, q}$ 的所有线性组合是方程组 $\vec \alpha = k_1 \vec \alpha_1 + \cdots + k_s \vec \alpha_s = l_1 \vec \beta_1 + \cdots + l_t \vec \beta_t$ 的所有解，由此可知它的每个向量取前 $s$ 个数形成的缩短组是方程组 $\vec \alpha = k_1 \vec \alpha_1 + \cdots + k_s \vec \alpha_s$ 的基础解系，从而 $a_{i1} \vec \alpha_1 + \cdots + a_{is} \vec \alpha_s \pod{i = 1, \cdots, q}$ 是 $V_1 \cap V_2$ 的一组基。
	\end{enumerate}
\end{solve}