% Licensed under the Creative Commons Attribution Share Alike 4.0 International.
% See the LICENCE file in the repository root for full licence text.

\section{可逆矩阵}

矩阵乘法是否具有逆？为了研究这个问题，我们需要先定义相关概念，并给出一系列显然的定理。

\begin{definition}{可逆矩阵,非奇异矩阵}
	对于数域 $\mathbb K$ 上的矩阵 $A$，如果存在数域 $\mathbb K$ 上的矩阵 $B$，使得 $AB = BA = I$，那么称 $A$ 是\emph{可逆矩阵}（或\emph{非奇异矩阵}）。
\end{definition}

根据定义，\textbf{可逆矩阵一定是方阵}。

\begin{definition}{逆矩阵}
	如果 $A$ 是可逆矩阵，那么适合 $AB = BA = I$ 的矩阵 $B$ 称为 $A$ 的\emph{逆矩阵}，记作 $A^{-1}$。
\end{definition}

\begin{theorem}
	逆矩阵如果存在，那么它是唯一的。
\end{theorem}

\begin{proof}
	若 $A$ 是可逆矩阵，对于 $A$ 的任意两个逆矩阵 $B, C$，有：
	$$
	B = BI = BAC = IC = C
	$$
\end{proof}

如果 $A$ 是可逆矩阵，那么根据 $|AB| = |A| |B| = |B| |A| = |BA|$，可知 $|A| \ne 0$ 是其逆矩阵存在的必要条件，因为：
$$
|A A^{-1}| = |I_n| = 1 = |A| |A^{-1}|
$$

我们自然地想知道，$|A| \ne 0$ 是可逆的充分必要条件吗？为了研究这个问题，我们需要借助下文的初等矩阵。

\subsection{初等矩阵}

初等矩阵概念的提出源于以下定理。

\begin{theorem}
	初等行变换都是线性变换。
\end{theorem}

\begin{proof}
	只需找到初等行变换对应的矩阵，因为矩阵和线性映射有着一一对应关系。
	\begin{enumerate}
		\item 对于交换第 $i, j$ 两行（不妨设 $i < j$），该矩阵为：
		$$
		P(i, j) =
		\begin{bmatrix}
			\vec e_1 \\ \vdots \\ \vec e_j \\ \vdots \\ \vec e_i \\ \vdots \\ \vec e_n
		\end{bmatrix}
		$$

		可以验证，$P(i, j) A$ 等于将 $A$ 的第 $i, j$ 两行交换后得到的矩阵。

		\item 对于第 $i$ 行乘以 $c$，该矩阵为：
		$$
		P(i(c)) =
		\begin{bmatrix}
			\vec e_1 \\ \vdots \\ c \vec e_i \\ \vdots \\ \vec e_n
		\end{bmatrix}
		$$

		可以验证，$P(i(c)) A$ 等于将 $A$ 的第 $i$ 行乘以 $c$ 后得到的矩阵。

		\item 对于第 $i$ 行加上第 $j$ 行的 $k$ 倍，该矩阵为：
		$$
		P(i, j(c)) =
		\begin{bmatrix}
			\vec e_1 \\ \vdots \\ \vec e_i + k \vec e_j \\ \vdots \\ \vec e_n
		\end{bmatrix}
		$$

		可以验证，$P(i, j(k)) A$ 等于将 $A$ 的第 $i$ 行加上第 $j$ 行的 $k$ 倍得到的矩阵。
	\end{enumerate}
\end{proof}

以上证明过程反映了两个重要信息：
\begin{enumerate}
	\item 代入 $A = I$，则可知 $P(i, j), P(i(c)), P(i, j(k))$ 是单位矩阵经过一次初等行变换的结果。
	\item 观察 $P(i, j), P(i(c)), P(i, j(k))$ 的结构，可知它们也可以由单位矩阵经过一次初等列变换得到。
\end{enumerate}

所以，我们用以下形式给出初等矩阵的定义。

\begin{definition}{初等矩阵}
	由单位矩阵经过一次初等行（列）变换得到的矩阵称为\emph{初等矩阵}。记号如下。

	\begin{enumerate}
		\item 用 $P(i, j(k))$ 表示将第 $i$ 行加上第 $j$ 行的 $k$ 倍对应的初等矩阵。
		\item 用 $P(i, j)$ 表示将第 $i$ 行与第 $j$ 行交换对应的初等矩阵。
		\item 用 $P(i(c))$ 表示将第 $i$ 行乘上 $c$ 倍对应的初等矩阵（$c \ne 0$）。
	\end{enumerate}
\end{definition}

初等矩阵与其他矩阵相乘的含义如下定理所述。

\begin{theorem}
	用初等矩阵左（右）乘 $A$，就相当于 $A$ 做了一次相应的初等行（列）变换。具体含义如下：
	\begin{enumerate}
		\item 用 $P(i, j(k))$ \textbf{左乘} $A$，相当于把 $A$ 的第 $j$ 行的 $k$ 倍加到第 $i$ 行上，其余行不变。
		\item 用 $P(i, j(k))$ \textbf{右乘} $A$，相当于把 $A$ 的第 $i$ 列的 $k$ 倍加到第 $j$ 列上，其余列不变（注意 $i$ 和 $j$ 互换了）。
		\item 用 $P(i, j)$ 左（右）乘 $A$，相当于把 $A$ 的第 $i$ 行（列）与第 $j$ 行（列）互换，其余行（列）不变。
		\item 用 $P(i(c)) \pod{c \ne 0}$ 左（右）乘 $A$，相当于用 $c$ 乘 $A$ 的第 $i$ 行（列），其余行（列）不变。
	\end{enumerate}
\end{theorem}

由此，我们将矩阵的乘法与初等变换联系起来了。利用初等变换的性质，我们可以得到以下有关初等矩阵的定理。

\begin{theorem}
	若 $|A| \ne 0$，则存在一系列初等矩阵的乘积 $P_s \cdots P_1$ 使得\footnote{$n$ 级矩阵的初等行变换不改变其行列式的非零性。}：
	$$
	P_s \cdots P_1 A = I_n
	$$
\end{theorem}

\begin{theorem}
	初等矩阵是可逆的。
\end{theorem}

\begin{proof}
	$$
	P^2(i, j) = I_n
	$$$$
	P(i(c)) P \biggl( i \biggl( \frac{1}{c} \biggr) \biggr) = I_n
	$$$$
	P(i, j(k)) P(i, j(-k)) = I_n
	$$
\end{proof}

\subsection{矩阵可逆的充分必要条件}

\begin{theorem}[矩阵可逆的充分必要条件]
	设 $A$ 是数域 $\mathbb K$ 上的方阵。以下五个命题等价：
	\begin{enumerate}
		\item $A$ 是可逆矩阵，即存在矩阵 $B$ 使得 $AB = BA = I_n$。
		\item $|A| \ne 0$。
		\item $A$ 可以写成一系列初等矩阵的乘积。
		\item 存在一个数域 $\mathbb K$ 上的方阵 $B$，使得 $AB = I_n$。
		\item 存在一个数域 $\mathbb K$ 上的方阵 $B$，使得 $BA = I_n$
	\end{enumerate}
\end{theorem}

\begin{proof}[$1 \Longrightarrow 2$]
	由 $AB = I_n$，可知 $|A| |B| = 1$，于是 $|A| \ne 0$。
\end{proof}

\begin{proof}[$2 \Longrightarrow 3$]
	由 $|A| \ne 0$，可知 $\operatorname{rank}(A) = n$，则存在一系列初等矩阵的乘积 $P_s \cdots P_1$，使得 $P_s \cdots P_1 A = I_n$，从而 $A^{-1} = P_s \cdots P_1$，于是 $A = P_1^{-1} \cdots P_s^{-1}$。
\end{proof}

\begin{proof}[$3 \Longrightarrow 4$]
	若 $A = P_1 \cdots P_s$，则令 $B = P_s^{-1} \cdots P_1^{-1}$ 即可。
\end{proof}

\begin{proof}[$4 \Longrightarrow 5$]
	若 $AB = I_n$，则 $|A||B| \ne 0$，于是令 $A = Q_1 \cdots Q_t$，则 $B = Q_t^{-1} \cdots Q_1^{-1}$。显然满足 $BA = I_n$。
\end{proof}

\begin{proof}[$5 \Longrightarrow 1$]
	若 $BA = I_n$，则 $|B||A| \ne 0$，于是令 $A = Q_1 \cdots Q_t$，则 $B = Q_t^{-1} \cdots Q_1^{-1}$，显然满足 $AB = I_n = BA$。
\end{proof}

\subsection{可逆矩阵的性质}

以下两个性质是平凡的。

\begin{theorem}
	单位矩阵 $I$ 可逆，且 $I^{-1} = I$。
\end{theorem}

\begin{theorem}
	如果 $A$ 可逆，那么 $A^{-1}$ 也可逆，且 $(A^{-1})^{-1} = A$。
\end{theorem}

矩阵的运算是否改变矩阵的可逆性？以下两个性质表明，矩阵乘法和矩阵转置不改变可逆矩阵的可逆性。

\begin{theorem}
	如果 $n$ 级矩阵 $A, B$ 都可逆，那么 $AB$ 也可逆，并且 $(AB)^{-1} = B^{-1} A^{-1}$。
\end{theorem}

\begin{proof}
	因为 $A, B$ 都可逆，所以存在 $A^{-1}, B^{-1}$。由于：
	$$
	(AB)(B^{-1}A^{-1}) = A(BB^{-1})A^{-1} = AIA^{-1} = I
	$$

	所以 $AB$ 可逆，并且 $(AB)^{-1} = B^{-1} A^{-1}$。
\end{proof}

\begin{theorem}
	如果 $A$ 可逆，那么 $A'$ 也可逆，并且 $(A')^{-1} = (A^{-1})'$。
\end{theorem}

\begin{proof}
	$$
	A'(A^{-1})' = (A^{-1} A)' = I' = I
	$$
\end{proof}

下面的性质将矩阵的秩与含可逆矩阵的矩阵乘法联系了起来。

\begin{theorem}
	用一个可逆矩阵左（右）乘一个矩阵 $A$，不改变 $A$ 的秩。
\end{theorem}

\begin{proof}
	设 $P$ 为可逆矩阵，则存在初等矩阵 $P_1, \ldots, P_m$，使得 $P = P_1 \cdots P_m$。从而 $PA = P_1 \cdots P_n A$，即 $PA$ 相当于对 $A$ 做一系列初等行变换。由于初等行变换不改变矩阵的秩，所以 $\operatorname{rank}(PA) = \operatorname{rank}(A)$。

	下面证明右乘也成立。设 $Q$ 是可逆矩阵，则 $Q'$ 也是可逆矩阵，于是有：
	$$
	\operatorname{rank}(AQ) = \operatorname{rank}((AQ)') = \operatorname{rank}(Q'A') = \operatorname{rank}(A') = \operatorname{rank}(A)
	$$
\end{proof}

\subsection{求逆矩阵的方法}

\subsubsection{定义法}

要求 $A$ 的逆矩阵，只需构造等式 $AB = I_n$（或 $BA = I_n$），等式中的 $B$ 即为 $A$ 的逆矩阵。

例如，设 $A^2 + 2A - 3I_n = 0$，要求 $A$ 的逆矩阵，移项得：
$$
\dfrac{1}{3} A(A + 2 I_n) = I_n
$$

所以 $A$ 的逆矩阵为 $\dfrac{A + 2 I_n}{3}$。

\subsubsection{初等变换法}

初等变换法的原理如下。设 $A$ 经过一系列初等行变换后变换为了单位矩阵：
$$
P_s \cdots P_1 A = I_n
$$

则 $A^{-1} = P_s \cdots P_1$。由于：
$$
P_s \cdots P_1 = P_s \cdots P_1 I_n
$$

因此只需要对 $A$ 和 $I_n$ 同时进行相同的初等行变换。当 $A$ 变换为 $I_n$ 时，$I_n$ 即变换为了 $A^{-1}$。

\subsubsection{解方程组法}

假设 $A$ 存在逆矩阵，设 $A^{-1}$ 为：
$$
A^{-1} =
\begin{bmatrix}
	\vec \alpha_1 & \vec \alpha_2 & \cdots & \vec \alpha_n
\end{bmatrix}
$$

解以下 $n$ 个 $n$ 元线性方程组即可求解 $\vec \alpha_1, \vec \alpha_2, \ldots, \vec \alpha_n$：
$$
A \vec \alpha_i = \vec e_i \pod{i = 1, 2, \ldots, n}
$$

\subsubsection{伴随矩阵法}

设 $A = (a_{ij})$，记 $A_{ij}$ 表示 $A$ 的 $(i, j)$ 元的代数余子式。容易验证下式成立：
$$
\begin{bmatrix}
	a_{11} & \cdots & a_{1n}
	\\
	\vdots & & \vdots
	\\
	a_{n1} & \cdots & a_{nn}
\end{bmatrix}
\begin{bmatrix}
	A_{11} & \cdots & A_{\textcolor{red}{n1}}
	\\
	\vdots & & \vdots
	\\
	A_{\textcolor{red}{1n}} & \cdots & A_{nn}
\end{bmatrix}
=
\begin{bmatrix}
	|A| & \cdots & 0
	\\
	\vdots & & \vdots
	\\
	0 & \cdots & |A|
\end{bmatrix} = |A|I
$$

矩阵 $A^* = (A_{\textcolor{red}{ji}})$ 非常特殊，我们将它定义为 $A$ 的伴随矩阵。

\begin{definition}{伴随矩阵}
	设 $A = (a_{ij})$，记 $A_{ij}$ 表示 $A$ 的 $(i, j)$ 元的代数余子式。定义：
	$$
	A^* =
	\begin{bmatrix}
		A_{11} & \cdots & A_{n1}
		\\
		\vdots & & \vdots
		\\
		A_{1n} & \cdots & A_{nn}
	\end{bmatrix}
	$$

	称 $A^* = (A_{ji})$ 为 $A$ 的\emph{伴随矩阵}。
\end{definition}

由此，以下定理显然成立。

\begin{theorem}
	当 $A$ 可逆时，$A^{-1} = \dfrac{1}{|A|} A^*$。
\end{theorem}